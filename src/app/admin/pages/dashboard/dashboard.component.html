
<section class="medical-hero min-vh-100 d-flex align-items-center" *ngIf="verdasboard">
  <div class="container py-5">
    <!-- input oculto -->
    <input
      #fileInput
      type="file"
      accept=".xlsx,.xls,.csv"
      (change)="onFileSelected($event)"
      hidden
    />

    <div class="bento-grid">
      <!-- Tile: Carga de Excel -->

      <div class="bento-item item--upload card-glass" *ngIf="showfirstcard">
        <div class="item-inner">
          <div class="item-copy">
            <div class="item-icon">
              <i class="bi bi-file-earmark-spreadsheet"></i>
            </div>
            <h3 class="item-title">Carga de información</h3>
            <p class="item-sub">
              Sube tu archivo Excel/CSV y cargaremos la información de las cuentas.
            </p>

            <div class="row g-3 mt-2">
                <div class="col-12 col-md-6">
                  <label class="form-label">Periodo inicio</label>
                  <input
                    type="date"
                    class="form-control"
                    [(ngModel)]="periodoInicio"
                    (ngModelChange)="onInicioChange($event)"
                    [min]="todayISO"
                    [max]="maxInicioISO"
                    name="periodoInicio"
                    required
                  />
                  <small class="text-muted">Desde hoy ({{ todayISO }})</small>
                </div>

                <div class="col-12 col-md-6">
                  <label class="form-label">Periodo fin</label>
                  <input
                    type="date"
                    class="form-control"
                    [(ngModel)]="periodoFin"
                    [min]="finMin"
                    [max]="finMax"
                    name="periodoFin"
                    required
                  />
                  <small class="text-muted">
                    Entre {{ finMin }} y {{ finMax }}
                  </small>
                </div>
              </div>

            <div class="d-flex flex-wrap gap-3">
              <button class="btn btn-medical-primary" type="button" (click)="openPicker()">
                <i class="bi bi-cloud-upload"></i> Cargar Excel
              </button>
              <button class="btn btn-medical-success"
                      type="button"
                      [disabled]="!previewRows.length || uploading"
                      (click)="subir()">
                <i class="bi bi-send-check"></i>
                {{ uploading ? (' Subiendo... ' + progress + '%') : 'Enviar al servicio' }}
              </button>

            </div>

            <div class="mt-3 small text-muted" *ngIf="previewRows?.length">
              <i class="bi bi-check2-circle"></i>
              Registros listos: <strong>{{ previewRows.length }}</strong>
            </div>

            <div class="progress mt-2" *ngIf="uploading">
              <div class="progress-bar progress-bar-striped progress-bar-animated"
                   role="progressbar"
                   [style.width.%]="progress"
                   aria-valuemin="0" aria-valuemax="100"></div>
            </div>
          </div>


        </div>

      </div>

      <!-- Tile: Configuración -->




    </div> <!-- /bento-grid -->
  </div>
</section>
